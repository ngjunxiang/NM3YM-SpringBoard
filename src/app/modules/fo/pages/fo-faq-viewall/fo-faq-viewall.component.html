<p-growl [(value)]="msgs" [life]="5000" [style]="{zIndex:99999999}"></p-growl>

<div *ngIf="!loading">
    <form [formGroup]="questionForm" class="search-container">
        <input type="text" formControlName="question" class="form-control" (keyup.enter)="searchFAQ()" id="search-bar" placeholder="What would you like to search for?"
            required pInputText>
        <div class="search-icon" (click)="searchFAQ()">
            <i class="fa fa-search"></i>
        </div>
    </form>
    <br>

    <div class="ui-g" style="display: inline; ">
        <div class="ui-g-6" style="padding-left: 0px">
            Select Category:
            <p-dropdown [options]="sortOptions" [(ngModel)]="selectedSortOpt" (onChange)="onSortChange()"></p-dropdown>
        </div>
        <div class="ui-g-6">
            <button pButton label="Ask a Question" class="ui-button-success" style="float: right; width: 35%; margin-top: 1%" type="submit"
                icon="fas fa-share-square" (click)="showConfirmDialog()"></button>
        </div>
    </div>

    <p-dialog header="Confirmation" [(visible)]="confirmDialog" [modal]="true" [width]="auto">
        <div style="margin: 10px; font-size: 14px; font-weight: 400">
            Have you searched for your question?
        </div>
        <p-footer>
            <button pButton label="Yes" type="button" (click)="showAskDialog()"></button>
            <button pButton label="No" type="button" (click)="hideConfirmDialog()"></button>
        </p-footer>
    </p-dialog>

    <p-dialog styleClass="askDialog" header="Ask a Question" [(visible)]="askDialog" [closable]="true" [modal]="true" [maximizable]="true">
        <div style="margin-top: 10px; font-size: 15px; font-weight: 600">
            You are asking:
        </div>
        <form [formGroup]="newQuestionForm">
            <textarea class="form-control" formControlName="newQuestion" style="width: 100%; height: 100px;" size="30" #msgInput (keydown.enter)="confirmText(msgInput.value);false"
                pInputText></textarea>
        </form>

        <p-footer>
            <button pButton label="Done" class="ui-button-success" type="button" (click)="postNewQuestion()"></button>
            <button pButton label="Cancel" class="ui-button-danger" type="button" (click)="hideAskDialog()"></button>
        </p-footer>

    </p-dialog>

    <p-card styleClass="ui-card-shadow">
        <div *ngIf="!searched">
            <h4>Frequently Asked Questions</h4>
        </div>
        <div *ngIf="searched">
            <h4>Search Result</h4>
        </div>
        <div *ngIf="faqs.length === 0">
            <h5>
                There are no questions yet!
            </h5>
        </div>
        <div *ngIf="faqs.length > 0">
            <p-dataScroller [value]="faqs" [rows]="10" [loader]="loadButton">
                <ng-template let-faq pTemplate="items" ;>
                    <p-card class="questionCard clickable" (click)="showAnswerDialog(faq.qnID, faq.question,faq.answer)">
                        <div class="ui-g">
                            <div class="ui-g-9">
                                <div class="question" style="color:#3989e1; margin-bottom:12px">
                                    {{faq.question}}
                                </div>
                                <div style="font-size: 12px; font-weight: 600">
                                    <p>Posted on: 19/10/2018</p>
                                </div>
                            </div>
                            <div class="ui-g-3">
                                <div style="float: right; font-size: 12px; font-weight: 400">
                                    100 views
                                </div>
                            </div>
                        </div>
                    </p-card>
                </ng-template>
                <p-footer>
                    <button #loadButton type="text" icon="pi pi-refresh" pButton label="Load"></button>
                </p-footer>
            </p-dataScroller>
        </div>
    </p-card>

    <p-dialog styleClass="ansDialog" header="Answer View" [(visible)]="answerDialog" [closable]="true" [modal]="true" [maximizable]="true">
        <div style="font-size: 12px; font-weight: 600; padding-left: 7px">
            <i>Question:</i>
        </div>
        <div class="ui-g">
            <div class="ui-g-10 qnsInDialog" style="color:#3989e1; margin-bottom:12px">
                {{this.currentQuestion}}
            </div>
            <div class="ui-g-2" style="text-align: right; font-size: 12px; font-weight: 400">
                <!-- <p>Posted by: Jarrett Goh</p> -->
                <p>Posted on: 19/10/2018</p>
            </div>
        </div>
        <hr>

        <div style="font-size: 12px; font-weight: 600; padding-left: 7px">
            <i>Answer:</i>
        </div>
        <div class="ui-g">
            <div class="ui-g-10 ansInDialog" style="color:black; margin-bottom:12px">
                {{this.currentAnswer}}
            </div>

            <div class="ui-g-2" style="text-align: right; font-size: 12px; font-weight: 400">
                <!-- <p>Answered by: Randy Lai</p> -->
                <p>Answered on: 20/10/2018</p>
            </div>
        </div>

        <div style="float: right">
            100 views
        </div>

    </p-dialog>
</div>