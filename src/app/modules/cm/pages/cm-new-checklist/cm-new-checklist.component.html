<p-growl [(value)]="msgs" [life]=5000 [style]="{zIndex:99999999}"></p-growl>

<div *ngIf="!loading">
    <div class="form-create" [formGroup]="newChecklistForm">
        <div style="padding-bottom: 10px" id="checklistName">
            <p-card styleClass="ui-card-shadow">
                <h3>Checklist Name</h3>
                <input type="text" id="input" style="width: 83%" class="form-control" placeholder="Enter Checklist Name" formControlName="checklistName"
                    required pInputText>
            </p-card>
        </div>

        <div style="padding-bottom: 10px">
            <p-card styleClass="ui-card-shadow">
                <h3>Required Fields</h3>
                <div formArrayName="requiredFields">
                    <div *ngFor="let field of newChecklistForm.get('requiredFields').controls; let i=index">
                        <h4>Field {{i+1}}</h4>
                        <div [formGroupName]="i" class="ui-g">
                            <div class="ui-g-12 ui-md-10" style="margin-left: -8px">
                                <input type="text" id="input" class="form-control" style="display: inline-block; width: 92%" placeholder="Field (e.g. Client A/C Number)"
                                    formControlName="fieldName" required pInputText>
                                <button pButton [disabled]="newChecklistForm.get('requiredFields').length < 2" class="ui-button-danger" style="display: inline-block; width: 6%; margin-left: 2%"
                                    type="button" icon="fa fa-times" (click)="deleteField(i)"></button>
                            </div>
                        </div>
                    </div>
                </div>
                <button pButton label="Add New Field" class="ui-button-success" style="width: 20%" type="button" icon="fa fa-plus" (click)="addNewField()"></button>
            </p-card>
        </div>

        <div style="padding-bottom: 10px" id="conditions">
            <p-card styleClass="ui-card-shadow">
                <h3>Checklist Conditions</h3>
                <div formArrayName="conditions">
                    <div *ngFor="let condition of newChecklistForm.get('conditions').controls; let i=index">
                        <h4>Condition {{i+1}}</h4>
                        <div [formGroupName]="i" class="ui-g">
                            <div class="ui-g-12 ui-md-10" style="margin-left: -8px">
                                <input type="text" id="input" class="form-control" style="display: inline-block; width: 35%" placeholder="Condition (e.g. Booking Center)"
                                    formControlName="conditionName" required pInputText>
                                <input type="text" id="input" class="form-control" style="display: inline-block; width: 55%; margin-left: 2%" placeholder="Condition Options* (e.g. Singapore, Hong Kong)"
                                    formControlName="conditionOptions" required pInputText>
                                <button pButton [disabled]="newChecklistForm.get('conditions').length < 2" class="ui-button-danger" style="display: inline-block; width: 6%; margin-left: 2%"
                                    type="button" icon="fa fa-times" (click)="deleteCondition(i)"></button>
                            </div>
                        </div>
                    </div>
                </div>
                <button pButton label="Add New Condition" class="ui-button-success" style="width: 20%" type="button" icon="fa fa-plus" (click)="addNewCondition()"></button>
            </p-card>
        </div>
    </div>

    <div class="form-create" style="padding-bottom: 10px">
        <p-card styleClass="ui-card-shadow">
            <h3>Documents</h3>

            <p-tabMenu [model]="tabs" [activeItem]="activeTab"></p-tabMenu>

            <div *ngIf="activeTab ==='Compliance'" [formGroup]="complianceDocumentsForm">
                <h4>Mandatory</h4>
                <div *ngIf="complianceDocumentsForm.get('mandatory').length == 0">
                    No documents yet
                </div>
                <div *ngIf="complianceDocumentsForm.get('mandatory').length != 0">
                    Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>
                <div *ngFor="let doc of complianceDocumentsForm.get('mandatory').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Mandatory" class="ui-button-primary" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showMDialog()"></button>
                <p-dialog header="Add Mandatory Document" [(visible)]="mDisplay" [closable]="false" [width]="800">
                    <div formArrayName="mandatory">
                        <div *ngFor="let doc of complianceDocumentsForm.get('mandatory').controls; let i=index">
                            <div *ngIf="i == complianceDocumentsForm.get('mandatory').length - 1">
                                <div [formGroupName]="complianceDocumentsForm.get('mandatory').length - 1" class="ui-g">
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right: 4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton style="display: inline-block; width: 20%; margin-right:4%" label="Add" class="ui-button-success" type="button"
                                            icon="fa fa-plus" (click)="addNewMandatory()"></button>
                                        <button pButton style="display: inline-block; width: 20%" label="Cancel" class="ui-button-danger" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewMandatory()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>

                <h4>Conditional</h4>
                <div *ngIf="complianceDocumentsForm.get('conditional').length == 0">
                    No documents yet
                </div>
                <div *ngIf="complianceDocumentsForm.get('conditional').length != 0">
                    Condition Condition Options Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>

                <div *ngFor="let doc of complianceDocumentsForm.get('conditional').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Conditional" class="ui-button-info" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showCDialog()"></button>
                <p-dialog header="Add Conditional Document" [(visible)]="cDisplay" [closable]="false" [width]="800">
                    <div formArrayName="conditional">
                        <div *ngFor="let doc of complianceDocumentsForm.get('conditional').controls; let i=index">
                            <div *ngIf="i == complianceDocumentsForm.get('conditional').length - 1">
                                <div [formGroupName]="complianceDocumentsForm.get('conditional').length - 1">
                                    <h4>Conditions</h4>
                                    <div formArrayName="conditions">
                                        <div *ngFor="let condition of complianceDocumentsForm.get('conditional').get(i + '').get('conditions').controls; let j=index">
                                            <div style="padding-top:1%" *ngIf="complianceDocumentsForm.get('conditional').get(i + '').get('conditions')['length'] >= 0"
                                                [formGroupName]="j">
                                                <h5>Condition {{j+1}}</h5>
                                                <p-dropdown [options]="conditions" (onChange)="onConditionNameSelect($event.value)" placeholder="Select a condition" formControlName="conditionName"></p-dropdown>
                                                <p-dropdown [options]="conditionOptions" placeholder="Select a condition option" formControlName="conditionOption"></p-dropdown>
                                                <button pButton [disabled]="complianceDocumentsForm.get('conditional').get(i + '').get('conditions')['length'] < 2" class="ui-button-danger"
                                                    style="display: inline-block; width: 6%; margin-left: 2%" type="button" icon="fa fa-times"
                                                    (click)="deleteConditionalCondition(j)"></button>
                                            </div>
                                        </div>
                                        <div style="padding-top:1%">
                                            <button pButton label="Add Condition" class="ui-button-success" style="display: inline-block; width: 35%" type="button" icon="fa fa-plus"
                                                (click)="addNewConditionalCondition()"></button>
                                        </div>
                                    </div>
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right:4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton label="Add" class="ui-button-success" style="display: inline-block; width: 20%; margin-right:4%" type="button"
                                            icon="fa fa-plus" (click)="addNewConditional()"></button>
                                        <button pButton label="Cancel" class="ui-button-danger" style="display: inline-block; width: 20%" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewConditional()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>

                <h4>Optional</h4>
                <div *ngIf="complianceDocumentsForm.get('optional').length == 0">
                    No documents yet
                </div>
                <div *ngIf="complianceDocumentsForm.get('optional').length != 0">
                    Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>
                <div *ngFor="let doc of complianceDocumentsForm.get('optional').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Optional" class="ui-button-secondary" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showODialog()"></button>
                <p-dialog header="Add Optional Document" [(visible)]="oDisplay" [closable]="false" [width]="800">
                    <div formArrayName="optional">
                        <div *ngFor="let doc of complianceDocumentsForm.get('optional').controls; let i=index">
                            <div *ngIf="i == complianceDocumentsForm.get('optional').length - 1">
                                <div [formGroupName]="complianceDocumentsForm.get('optional').length - 1" class="ui-g">
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right:4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton label="Add" class="ui-button-success" style="display: inline-block; width: 20%; margin-right:4%" type="button"
                                            icon="fa fa-plus" (click)="addNewOptional()"></button>
                                        <button pButton label="Cancel" class="ui-button-danger" style="display: inline-block; width: 20%" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewOptional()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>
            </div>


            <div *ngIf="activeTab ==='Legal'" [formGroup]="legalDocumentsForm">
                <h4>Mandatory</h4>
                <div *ngIf="legalDocumentsForm.get('mandatory').length == 0">
                    No documents yet
                </div>
                <div *ngIf="legalDocumentsForm.get('mandatory').length != 0">
                    Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>
                <div *ngFor="let doc of legalDocumentsForm.get('mandatory').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Mandatory" class="ui-button-primary" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showMDialog()"></button>
                <p-dialog header="Add Mandatory Document" [(visible)]="mDisplay" [closable]="false" [width]="800">
                    <div formArrayName="mandatory">
                        <div *ngFor="let doc of legalDocumentsForm.get('mandatory').controls; let i=index">
                            <div *ngIf="i == legalDocumentsForm.get('mandatory').length - 1">
                                <div [formGroupName]="legalDocumentsForm.get('mandatory').length - 1" class="ui-g">
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right: 4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton style="display: inline-block; width: 20%; margin-right:4%" label="Add" class="ui-button-success" type="button"
                                            icon="fa fa-plus" (click)="addNewMandatory()"></button>
                                        <button pButton style="display: inline-block; width: 20%" label="Cancel" class="ui-button-danger" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewMandatory()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>

                <h4>Conditional</h4>
                <div *ngIf="legalDocumentsForm.get('conditional').length == 0">
                    No documents yet
                </div>
                <div *ngIf="legalDocumentsForm.get('conditional').length != 0">
                    Condition Condition Options Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>

                <div *ngFor="let doc of legalDocumentsForm.get('conditional').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Conditional" class="ui-button-info" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showCDialog()"></button>
                <p-dialog header="Add Conditional Document" [(visible)]="cDisplay" [closable]="false" [width]="800">
                    <div formArrayName="conditional">
                        <div *ngFor="let doc of legalDocumentsForm.get('conditional').controls; let i=index">
                            <div *ngIf="i == legalDocumentsForm.get('conditional').length - 1">
                                <div [formGroupName]="legalDocumentsForm.get('conditional').length - 1">
                                    <h4>Conditions</h4>
                                    <div formArrayName="conditions">
                                        <div *ngFor="let condition of legalDocumentsForm.get('conditional').get(i + '').get('conditions').controls; let j=index">
                                            <div style="padding-top:1%" *ngIf="legalDocumentsForm.get('conditional').get(i + '').get('conditions')['length'] >= 0"
                                                [formGroupName]="j">
                                                <h5>Condition {{j+1}}</h5>
                                                <p-dropdown [options]="conditions" (onChange)="onConditionNameSelect($event.value)" placeholder="Select a condition" formControlName="conditionName"></p-dropdown>
                                                <p-dropdown [options]="conditionOptions" placeholder="Select a condition option" formControlName="conditionOption"></p-dropdown>
                                                <button pButton [disabled]="legalDocumentsForm.get('conditional').get(i + '').get('conditions')['length'] < 2" class="ui-button-danger"
                                                    style="display: inline-block; width: 6%; margin-left: 2%" type="button" icon="fa fa-times"
                                                    (click)="deleteConditionalCondition(j)"></button>
                                            </div>
                                        </div>
                                        <div style="padding-top:1%">
                                            <button pButton label="Add Condition" class="ui-button-success" style="display: inline-block; width: 35%" type="button" icon="fa fa-plus"
                                                (click)="addNewConditionalCondition()"></button>
                                        </div>
                                    </div>
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right:4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton label="Add" class="ui-button-success" style="display: inline-block; width: 20%; margin-right:4%" type="button"
                                            icon="fa fa-plus" (click)="addNewConditional()"></button>
                                        <button pButton label="Cancel" class="ui-button-danger" style="display: inline-block; width: 20%" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewConditional()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>

                <h4>Optional</h4>
                <div *ngIf="legalDocumentsForm.get('optional').length == 0">
                    No documents yet
                </div>
                <div *ngIf="legalDocumentsForm.get('optional').length != 0">
                    Document Name Agmt Code Signature Required Can be waivered? Remarks
                </div>
                <div *ngFor="let doc of legalDocumentsForm.get('optional').controls; let i=index">
                    <div>
                        {{ doc.controls.documentName.value }} {{ doc.controls.agmtCode.value }} {{ doc.controls.signature.value }} {{ doc.controls.canWaiver.value
                        }} {{ doc.controls.remarks.value }}
                    </div>
                </div>
                <button pButton label="Optional" class="ui-button-secondary" style="display: inline-block; width: 20%" type="button" icon="fa fa-plus"
                    (click)="showODialog()"></button>
                <p-dialog header="Add Optional Document" [(visible)]="oDisplay" [closable]="false" [width]="800">
                    <div formArrayName="optional">
                        <div *ngFor="let doc of legalDocumentsForm.get('optional').controls; let i=index">
                            <div *ngIf="i == legalDocumentsForm.get('optional').length - 1">
                                <div [formGroupName]="legalDocumentsForm.get('optional').length - 1" class="ui-g">
                                    <h4>Document Name</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Document Name" formControlName="documentName" required pInputText>
                                    <h4>Agmt Code</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Agmt Code" formControlName="agmtCode" required pInputText>
                                    <h4>Remarks</h4>
                                    <input type="text" id="input" class="form-control" placeholder="Additional Remarks" formControlName="remarks" pInputText>
                                    <div class="ui-g" style="padding-right:4%">
                                        <p-checkbox binary="true" formControlName="signature"></p-checkbox>
                                        <h4>Signature required</h4>
                                    </div>
                                    <div class="ui-g">
                                        <p-checkbox binary="true" formControlName="canWaiver"></p-checkbox>
                                        <h4>Can be waived</h4>
                                    </div>
                                    <div class="ui-g-12">
                                        <button pButton label="Add" class="ui-button-success" style="display: inline-block; width: 20%; margin-right:4%" type="button"
                                            icon="fa fa-plus" (click)="addNewOptional()"></button>
                                        <button pButton label="Cancel" class="ui-button-danger" style="display: inline-block; width: 20%" type="button" icon="fa fa-minus"
                                            (click)="cancelAddNewOptional()"></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-dialog>
            </div>
        </p-card>
    </div>
    <button pButton label="Create Checklist" class="ui-button-success" style="width: 100%" type="button" icon="fa fa-plus" (click)="createChecklist()"></button>
</div>